ggplot(df, aes(x=Edge_to_Mask, col=Dataset))+
geom_density()+
scale_y_log10()+
xlab("Focus Dataset")+
ylab("Distance from RPA focus to axis mask (px)")
ggplot(df, aes(x=Edge_to_Mask, col=Dataset))+
geom_density()+
xlab("Distance from RPA focus to axis mask (px)")
ggplot(df, aes(x=Edge_to_Mask, col=Dataset))+
geom_histogram()+
xlab("Distance from RPA focus to axis mask (px)")
ggplot(df, aes(x=Edge_to_Mask, fill=Dataset))+
geom_histogram()+
xlab("Distance from RPA focus to axis mask (px)")
ggplot(df, aes(x=Edge_to_Mask, fill=Dataset))+
geom_histogram(alpha=0.8)+
xlab("Distance from RPA focus to axis mask (px)")
?geom_histogramm
?geom_histogram
ggplot(df, aes(x=Edge_to_Mask, fill=Dataset))+
geom_histogram(alpha=0.8, dodge=1)+
xlab("Distance from RPA focus to axis mask (px)")
ggplot(df, aes(x=Edge_to_Mask, fill=Dataset))+
geom_histogram(alpha=0.8, position="dodge")+
xlab("Distance from RPA focus to axis mask (px)")
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig 5 Axial shuffling/Obs vs Shf focus nuclear distances.pdf")
ggplot(df, aes(x=Edge_to_Mask, fill=Dataset))+
geom_histogram(alpha=0.8, position="dodge")+
xlab("Distance from RPA focus to axis mask (px)")
dev.off()
list.files("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/SIM test data/SIM test image_Output")
read.csv("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/SIM test data/SIM test image_Output/Axis_Trace_Measurements.csv")
traces<-read.csv("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/SIM test data/SIM test image_Output/Axis_Trace_Measurements.csv")
unique(traces$name)
traces%>%mutate(Chromosome=recode(name, "a"="", "b"=""))
traces%>%mutate(Chromosome=str_replace(name, "a", ""))%>%
mutate(Chromosome=str_replace(Chromosome, "b", ""))
traces%>%group_by(Chromosome)%>%tally()
traces<-traces%>%mutate(Chromosome=str_replace(name, "a", ""))%>%
mutate(Chromosome=str_replace(Chromosome, "b", ""))
#Quantify total homologue length, for organising colours etc
traces%>%group_by(Chromosome)%>%tally()
trace_ranking<-traces%>%group_by(Chromosome)%>%tally()
trace_ranking%>%rank(n)
order(trace_ranking$n)
rank(trace_ranking$n)
-rank(trace_ranking$n)
rank(-trace_ranking$n)
trace_ranking$rank<-rank(-trace_ranking$n)
merge(traces,trace_ranking, by=c("Chromosome"))
traces<-merge(traces,trace_ranking, by=c("Chromosome"))
ggplot(traces)+
geom_point(aes(x=x,y=y, col=Chromosome))
ggplot(traces)+
geom_point(aes(x=x,y=y, col=Chromosome), alpha=0.7)
ggplot(traces)+
geom_point(aes(x=x,y=y, col=Chromosome), alpha=0.3)
ggplot(traces)+
geom_point(aes(x=x,y=y, col=Chromosome), alpha=0.1)
ggplot(traces)+
geom_point(aes(x=x,y=y, col=Chromosome), size=0.01, alpha=0.2)
ggplot(traces)+
geom_point(aes(x=x,y=y, col=Chromosome), size=0.01, alpha=0.2)+
theme_void()+theme(legend.position = "none")
trace[traces$Percentage_distance_euclidian==0,]
Centromere<-traces[traces$Percentage_distance_euclidian==0,]
Centromere
Centromere<-traces[traces$Percentage_distance_euclidian==0,]
Telomere<-traces[traces$Percentage_distance_euclidian==100,]
Centromere$End<-"Cetromere"
Telomere$End<-"Telomere"
ggplot(traces)+
geom_point(aes(x=x,y=y, col=Chromosome), size=0.01, alpha=0.2)+
theme_void()+theme(legend.position = "none")+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=1,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=1,alpha=0.5, pch=21)
library(ggplot2)
library(ggthemes)
library(gridExtra)
library(viridis)
library(ggnewscale)
##Plotting the inter-axis distances calculated in python code
Axis_Trace<-read.csv("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/JamesC/Backup from smbhost/My Documents/PostDoc/Syce3 Project/Image analysis trial/Registered Blind/Group 2/47564/Axis_Trace_Measurements.csv")
Plot<-ggplot(Axis_Trace)+geom_point(aes(x=x,y=y,col=Percentage_distance_euclidian), size=0.01,alpha=0.2)+ylim(0,1019)+xlim(0,1019)+
scale_color_gradient(low="red",high="blue")+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
theme_void()+theme(legend.position = "none")
Plot
ggplot(Axis_Trace)+geom_point(aes(x=x,y=y,col=Percentage_distance_euclidian), size=0.01,alpha=0.2)+ylim(0,1019)+xlim(0,1019)+
scale_color_gradient(low="red",high="blue")+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
theme_void()+theme(legend.position = "none")+coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
ggplot(Axis_Trace)+geom_point(aes(x=x,y=y,col=Percentage_distance_euclidian), size=0.01,alpha=0.2)+ylim(0,1019)+xlim(0,1019)+
scale_color_gradient(low="red",high="blue")+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
theme_void()+theme(legend.position = "none")+coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
ggplot(Axis_Trace)+geom_point(aes(x=x,y=y,col=Percentage_distance_euclidian), size=1,alpha=0.2)+ylim(0,1019)+xlim(0,1019)+
scale_color_gradient(low="red",high="blue")+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
theme_void()+theme(legend.position = "none")+coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
ggplot(Axis_Trace)+geom_point(aes(x=x,y=y,fill=Percentage_distance_euclidian), size=1,alpha=0.2)+ylim(0,1019)+xlim(0,1019)+
scale_fill_gradient(low="red",high="blue")+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
theme_void()+theme(legend.position = "none")+coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
ggplot(Axis_Trace)+geom_point(aes(x=x,y=y,col=Percentage_distance_euclidian), size=1,alpha=0.3)+ylim(0,1019)+xlim(0,1019)+
scale_color_gradient(low="red",high="blue")+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
theme_void()+theme(legend.position = "none")+coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
ggplot(Axis_Trace)+geom_point(aes(x=x,y=y,col=Percentage_distance_euclidian), size=0.5,alpha=0.3)+ylim(0,1019)+xlim(0,1019)+
scale_color_gradient(low="red",high="blue")+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
theme_void()+theme(legend.position = "none")+coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
ggplot(Axis_Trace)+geom_point(aes(x=x,y=y,col=Percentage_distance_euclidian), size=2,alpha=0.3)+ylim(0,1019)+xlim(0,1019)+
scale_color_gradient(low="red",high="blue")+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
theme_void()+theme(legend.position = "none")+coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=Percentage_distance_euclidian), size=2,alpha=0.3, stroke=NA)+
ylim(0,1019)+
xlim(0,1019)+
scale_color_gradient(low="red",high="blue")+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
theme_void()+theme(legend.position = "none")+coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=Percentage_distance_euclidian), size=3,alpha=0.3, stroke=NA)+
ylim(0,1019)+
xlim(0,1019)+
scale_color_gradient(low="red",high="blue")+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
theme_void()+theme(legend.position = "none")+coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
Plot_zoom<-ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=Percentage_distance_euclidian), size=3,alpha=0.3, stroke=NA)+
ylim(0,1019)+
xlim(0,1019)+
scale_color_gradient(low="red",high="blue")+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
theme_void()+theme(legend.position = "none")+coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig4 Trace distances/Asynapsed_Trace_Orientated_zoom.pdf")
Plot_zoom
dev.off()
Plot2<-ggplot(Axis_Trace)+theme_void()+geom_point(aes(x=x,y=y),col="Gray", size=0.1,alpha=0.2)+ylim(0,1019)+xlim(0,1019)+
geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+scale_color_viridis(trans="log")+
theme(legend.position = "none")
Plot2
ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=Percentage_distance_euclidian), size=3,alpha=0.3, stroke=NA)+
scale_color_gradient(low="red",high="blue")+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
theme_void()+theme(legend.position = "none")+coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
ggplot(Axis_Trace)+theme_void()+
geom_point(aes(x=x,y=y),col="Gray", size=0.1,alpha=0.2)+
ylim(0,1019)+xlim(0,1019)+
geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
scale_color_viridis(trans="log")+
theme(legend.position = "none")
library(ggplot2)
library(ggthemes)
library(gridExtra)
library(viridis)
library(ggnewscale)
Plot2_Zoom<-ggplot(Axis_Trace)+theme_void()+
geom_point(aes(x=x,y=y),col="Gray", size=0.1,alpha=0.2)+
ylim(0,1019)+xlim(0,1019)+
geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
scale_color_viridis(trans="log")+
theme(legend.position = "none")+
coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
Plot2_Zoom<-ggplot(Axis_Trace)+theme_void()+
geom_point(aes(x=x,y=y),col="Gray", size=0.1,alpha=0.2)+
geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
scale_color_viridis(trans="log")+
theme(legend.position = "none")+
coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
Plot2_Zoom
ggplot(Axis_Trace)+
theme_void()+
geom_point(aes(x=x,y=y),col="Gray", size=3,alpha=0.3, stroke=NA)+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
scale_color_viridis(trans="log")+
theme(legend.position = "none")+
coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
Plot2_Zoom<-ggplot(Axis_Trace)+
theme_void()+
geom_point(aes(x=x,y=y),col="Gray", size=3,alpha=0.3, stroke=NA)+
geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
scale_color_viridis(trans="log")+
theme(legend.position = "none")+
coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
Plot2_Zoom
Axis_Trace_distances_filtered<-Axis_Trace%>%filter(Distance.from.homolog>0)
Plot2_Zoom<-ggplot(Axis_Trace)+
theme_void()+
geom_point(aes(x=x,y=y),col="Gray", size=3,alpha=0.3, stroke=NA)+
geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.3)+
scale_color_viridis(trans="log")+
theme(legend.position = "none")+
coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig4 Trace distances/Asynapsed_Trace_Distances_Zoom.pdf")
Plot2_Zoom
dev.off()
#Plot to indicate the different pairs of autosomes with
temp<-gsub("a","",Axis_Trace$name)
Axis_Trace$Chromosome_Number<-gsub("b","",temp)#add column of chromosome ID shared between partners
#Centromere and telomere coordinates
Centromere<-Axis_Trace[Axis_Trace$Percentage_distance_euclidian==0,]
Telomere<-Axis_Trace[Axis_Trace$Percentage_distance_euclidian==100,]
Centromere$End<-"Cetromere"
Telomere$End<-"Telomere"
ggplot(Axis_Trace)+geom_point(aes(x=x,y=y,col=Chromosome_Number,alpha=(100/Percentage_distance_euclidian)), size=0.5)+
ylim(0,1019)+xlim(0,1019)+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=1,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=1,alpha=0.5, pch=21)+
theme_void()+theme(legend.position = "none")
Telomere
Centromere
ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=Chromosome_Number,alpha=(100/Percentage_distance_euclidian)), size=3, stroke=NA)+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=3,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=3,alpha=0.5, pch=21)+
theme_void()+
theme(legend.position = "none")+
coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=Chromosome_Number,alpha=0.3, size=3, stroke=NA)+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=3,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=3,alpha=0.5, pch=21)+
theme_void()+
theme(legend.position = "none")+
coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
ggplot(Axis_Trace)+
ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=Chromosome_Number,alpha=0.3, size=3, stroke=NA)+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=5,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=5,alpha=0.5, pch=21)+
theme_void()+
theme(legend.position = "none")+
coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
Plot3_Zoom<-ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=Chromosome_Number,alpha=0.3, size=3, stroke=NA))+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=5,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=5,alpha=0.5, pch=21)+
theme_void()+
theme(legend.position = "none")+
coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
Plot3_Zoom
ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=Chromosome_Number,alpha=0.2, size=3, stroke=NA))+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=5,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=5,alpha=0.5, pch=21)+
theme_void()+
theme(legend.position = "none")+
coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
Plot3_Zoom<-ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=Chromosome_Number,alpha=0.2, size=3, stroke=NA))+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=5,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=5,alpha=0.5, pch=21)+
theme_void()+
theme(legend.position = "none")+
coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig4 Trace distances/Asynapsed_Traces_Termini_and_Paired_Zoom.pdf")
Plot3_Zoom
dev.off()
Plot3_Zoom<-ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=Chromosome_Number,alpha=0.1, size=2, stroke=NA))+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=5,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=5,alpha=0.5, pch=21)+
theme_void()+
theme(legend.position = "none")+
coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig4 Trace distances/Asynapsed_Traces_Termini_and_Paired_Zoom.pdf")
Plot3_Zoom
dev.off()
Plot3_Zoom
Plot3_Zoom<-ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=Chromosome_Number,alpha=0.0.1, size=2, stroke=NA))+
Plot3_Zoom<-ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=Chromosome_Number,alpha=0.01, size=2, stroke=NA))+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=5,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=5,alpha=0.5, pch=21)+
theme_void()+
theme(legend.position = "none")+
coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig4 Trace distances/Asynapsed_Traces_Termini_and_Paired_Zoom.pdf")
Plot3_Zoom
dev.off()
Plot3_Zoom<-ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=Chromosome_Number,alpha=0.01, size=1, stroke=NA))+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=5,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=5,alpha=0.5, pch=21)+
theme_void()+
theme(legend.position = "none")+
coord_cartesian(xlim=c(625, 875), ylim=c(500,750))
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig4 Trace distances/Asynapsed_Traces_Termini_and_Paired_Zoom.pdf")
Plot3_Zoom
dev.off()
WT_Trace_Data<-read.csv("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/JamesC/Backup from smbhost/Apple folder/Images/Scp3 Rad51 Syce2/RAD51 SCP3 SYCE2 B6 SIM/Blind Projections/All_Trace_Data.csv")
FileNames<-unique(WT_Trace_Data$Codename)
WT_Trace_Count<-data.frame()
for(i in FileNames){
Name<-i
Total_Traces<-length(unique(WT_Trace_Data[WT_Trace_Data[,"Codename"]==Name,"id"]))
Original_Name<-unique(WT_Trace_Data[WT_Trace_Data[,"Codename"]==Name,"Original_Name"])[1]
temp<-data.frame(Image=Name,Traces=Total_Traces,Original_Name=Original_Name)
WT_Trace_Count<-rbind(WT_Trace_Count,temp)
}
WT_Trace_Count[WT_Trace_Count$Traces==40,]#choosing fully traced images
WT_Trace_Data<-read.csv("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/JamesC/Backup from smbhost/Apple folder/Images/Scp3 Rad51 Syce2/RAD51 SCP3 SYCE2 B6 SIM/Blind Projections/All_Trace_Data.csv")
FileNames<-unique(WT_Trace_Data$Codename)
WT_Trace_Count<-data.frame()
for(i in FileNames){
Name<-i
Total_Traces<-length(unique(WT_Trace_Data[WT_Trace_Data[,"Codename"]==Name,"id"]))
Original_Name<-unique(WT_Trace_Data[WT_Trace_Data[,"Codename"]==Name,"Original_Name"])[1]
temp<-data.frame(Image=Name,Traces=Total_Traces,Original_Name=Original_Name)
WT_Trace_Count<-rbind(WT_Trace_Count,temp)
}
WT_Trace_Count[WT_Trace_Count$Traces==40,]#choosing fully traced images
##Plotting the inter-axis distances calculated in python code
Axis_Trace<-read.csv("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/JamesC/Backup from smbhost/Apple folder/Images/Scp3 Rad51 Syce2/RAD51 SCP3 SYCE2 B6 SIM/Blind Projections/26068/Axis_Trace_Measurements.csv")
Plot_zoom<-ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=Percentage_distance_euclidian), size=3,alpha=0.3, stroke=NA)+
scale_color_gradient(low="red",high="blue")+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
theme_void()+theme(legend.position = "none")+
coord_cartesian(xlim=c(125,375), ylim=c(500,750))
Plot_zoom
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig4 Trace distances/Synapsed_Trace_Zoom.pdf")
Plot_zoom
dev.off()
Plot2_Zoom<-ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y),col="Gray", size=3,alpha=0.3, stroke=NA)+
geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.3)+
scale_color_viridis(trans="log")+
theme(legend.position ="none")+
coord_cartesian(xlim=c(125,375), ylim=c(500,750))+
theme_void()+ theme(legend.position ="none")
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig4 Trace distances/Synapsed_Trace_Distances_Zoom.pdf")
Plot2_Zoom
dev.off()
Plot2_Zoom
#Plot to indicate the different pairs of autosomes with
temp<-gsub("a","",Axis_Trace$name)
Axis_Trace$Chromosome_Number<-gsub("b","",temp)#add column of chromosome ID shared between partners
#Centromere and telomere coordinates
Centromere<-Axis_Trace[Axis_Trace$Percentage_distance_euclidian==0,]
Telomere<-Axis_Trace[Axis_Trace$Percentage_distance_euclidian==100,]
Centromere$End<-"Cetromere"
Telomere$End<-"Telomere"
Plot3_Zoom<-ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=Chromosome_Number,alpha=0.01, size=1, stroke=NA))+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=5,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=5,alpha=0.5, pch=21)+
theme_void()+
theme(legend.position = "none")+
coord_cartesian(xlim=c(125,375), ylim=c(500,750))
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig4 Trace distances/Synapsed_Traces_Termini_and_Paired_Zoom.pdf")
Plot3_Zoom
dev.off()
head(Axis_Trace)
trace_ranking<-Axis_Trace%>%group_by(Chromosome_Number)%>%tally()
trace_ranking$rank<-rank(-trace_ranking$n)
trace_ranking
Axis_Trace<-merge(Axis_Trace,trace_ranking, by=c("Chromosome"))
Axis_Trace<-merge(Axis_Trace,trace_ranking, by=c("Chromosome_Number"))
Plot3<-ggplot(Axis_Trace)+geom_point(aes(x=x,y=y,col=Chromosome_Number,alpha=(100/Percentage_distance_euclidian)), size=0.5)+
ylim(0,1019)+xlim(0,1019)+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=1,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=1,alpha=0.5, pch=21)+
theme_void()+theme(legend.position = "none")
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig4 Trace distances/Synapsed_Traces_Termini_and_Paired.pdf")
Plot3
dev.off()
Plot3_Zoom<-ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=Chromosome_Number,alpha=0.01, size=1, stroke=NA))+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=5,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=5,alpha=0.5, pch=21)+
theme_void()+
theme(legend.position = "none")+
coord_cartesian(xlim=c(125,375), ylim=c(500,750))
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig4 Trace distances/Synapsed_Traces_Termini_and_Paired_Zoom.pdf")
Plot3_Zoom
dev.off()
Plot3<-ggplot(Axis_Trace)+geom_point(aes(x=x,y=y,col=rank,alpha=(100/Percentage_distance_euclidian)), size=0.5)+
ylim(0,1019)+xlim(0,1019)+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=1,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=1,alpha=0.5, pch=21)+
theme_void()+theme(legend.position = "none")
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig4 Trace distances/Synapsed_Traces_Termini_and_Paired.pdf")
Plot3
dev.off()
Plot3_Zoom<-ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=rank,alpha=0.01, size=1, stroke=NA))+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=5,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=5,alpha=0.5, pch=21)+
theme_void()+
theme(legend.position = "none")+
coord_cartesian(xlim=c(125,375), ylim=c(500,750))
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig4 Trace distances/Synapsed_Traces_Termini_and_Paired_Zoom.pdf")
Plot3_Zoom
dev.off()
rank(-trace_ranking$n)
View(ranked_autosomes)
str(rank(-trace_ranking$n))
as.character(rank(-trace_ranking$n))
trace_ranking$rank<-as.character(rank(-trace_ranking$n))
Axis_Trace<-merge(Axis_Trace,trace_ranking, by=c("Chromosome_Number"))
##Plotting the inter-axis distances calculated in python code
Axis_Trace<-read.csv("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/JamesC/Backup from smbhost/Apple folder/Images/Scp3 Rad51 Syce2/RAD51 SCP3 SYCE2 B6 SIM/Blind Projections/26068/Axis_Trace_Measurements.csv")
#Quantify total homologue length, for organising colours etc
trace_ranking<-Axis_Trace%>%group_by(Chromosome_Number)%>%tally()
#Plot to indicate the different pairs of autosomes with
temp<-gsub("a","",Axis_Trace$name)
Axis_Trace$Chromosome_Number<-gsub("b","",temp)#add column of chromosome ID shared between partners
#Centromere and telomere coordinates
Centromere<-Axis_Trace[Axis_Trace$Percentage_distance_euclidian==0,]
Telomere<-Axis_Trace[Axis_Trace$Percentage_distance_euclidian==100,]
Centromere$End<-"Cetromere"
Telomere$End<-"Telomere"
Plot3<-ggplot(Axis_Trace)+geom_point(aes(x=x,y=y,col=rank,alpha=(100/Percentage_distance_euclidian)), size=0.5)+
ylim(0,1019)+xlim(0,1019)+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=1,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=1,alpha=0.5, pch=21)+
theme_void()+theme(legend.position = "none")
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig4 Trace distances/Synapsed_Traces_Termini_and_Paired.pdf")
Plot3
Centromere
Plot3<-ggplot(Axis_Trace)+geom_point(aes(x=x,y=y,col=rank,alpha=(100/Percentage_distance_euclidian)), size=0.5)+
ylim(0,1019)+xlim(0,1019)+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=1,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=1,alpha=0.5, pch=21)+
theme_void()+theme(legend.position = "none")
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig4 Trace distances/Synapsed_Traces_Termini_and_Paired.pdf")
Plot3
unique(Axis_Trace$rank)
##Plotting the inter-axis distances calculated in python code
Axis_Trace<-read.csv("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/JamesC/Backup from smbhost/Apple folder/Images/Scp3 Rad51 Syce2/RAD51 SCP3 SYCE2 B6 SIM/Blind Projections/26068/Axis_Trace_Measurements.csv")
#Quantify total homologue length, for organising colours etc
trace_ranking<-Axis_Trace%>%group_by(Chromosome_Number)%>%tally()
head(Axis_Trace)
#Plot to indicate the different pairs of autosomes with
temp<-gsub("a","",Axis_Trace$name)
Axis_Trace$Chromosome_Number<-gsub("b","",temp)#add column of chromosome ID shared between partners
trace_ranking<-Axis_Trace%>%group_by(Chromosome_Number)%>%tally()
trace_ranking
trace_ranking$rank<-as.character(rank(-trace_ranking$n))
Axis_Trace<-merge(Axis_Trace,trace_ranking, by=c("Chromosome_Number"))
#Centromere and telomere coordinates
Centromere<-Axis_Trace[Axis_Trace$Percentage_distance_euclidian==0,]
Telomere<-Axis_Trace[Axis_Trace$Percentage_distance_euclidian==100,]
Centromere$End<-"Cetromere"
Telomere$End<-"Telomere"
Plot3<-ggplot(Axis_Trace)+geom_point(aes(x=x,y=y,col=rank,alpha=(100/Percentage_distance_euclidian)), size=0.5)+
ylim(0,1019)+xlim(0,1019)+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=1,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=1,alpha=0.5, pch=21)+
theme_void()+theme(legend.position = "none")
Plot3
Plot3
Plot3_Zoom<-ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=rank,alpha=0.01, size=1, stroke=NA))+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=5,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=5,alpha=0.5, pch=21)+
theme_void()+
theme(legend.position = "none")+
coord_cartesian(xlim=c(125,375), ylim=c(500,750))
Plot3_Zoom
Plot3<-ggplot(Axis_Trace)+geom_point(aes(x=x,y=y,col=rank,alpha=(100/Percentage_distance_euclidian)), size=0.5)+
ylim(0,1019)+xlim(0,1019)+
# geom_segment(aes(x=x,y=y,xend=Neighbour.px.x,yend=Neighbour.px.y,col=Distance.from.homolog),alpha=0.5,size=0.1)+
# scale_color_viridis(trans="log")+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=1,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=1,alpha=0.5, pch=21)+
theme_void()+theme(legend.position = "none")
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig4 Trace distances/Synapsed_Traces_Termini_and_Paired.pdf")
Plot3
dev.off()
Plot3_Zoom<-ggplot(Axis_Trace)+
geom_point(aes(x=x,y=y,col=rank,alpha=0.01, size=1, stroke=NA))+
geom_point(data=Centromere,aes(x=x,y=y), fill="White",col="Black",size=5,alpha=0.5,pch=21)+
geom_point(data=Telomere,aes(x=x,y=y), fill="Black",col="Black",,size=5,alpha=0.5, pch=21)+
theme_void()+
theme(legend.position = "none")+
coord_cartesian(xlim=c(125,375), ylim=c(500,750))
pdf("//cmvm.datastore.ed.ac.uk/igmm/iadams-lab/Meiosis Plugin Paper/Methods in Molecular Biology - Meiosis image analysis/Figures/Fig4 Trace distances/Synapsed_Traces_Termini_and_Paired_Zoom.pdf")
Plot3_Zoom
dev.off()
dev.off()
